<MudDataGrid @ref="@DataGrid"
             T="StockViewModel"
             ServerData="@LoadServerData"
             Dense
             Hover
             Loading="@IsLoading"
             Filterable="false"
             Class="stocks-grid">

    <ToolBarContent>
        <MudText Typo="Typo.h6">@Localizer["stocks_grid_title"]</MudText>

        <MudSpacer/>

        <MudStack Row="true" 
                  Spacing="5" 
                  Class="toolbar-actions">

            <MudTextField T="string"
                          Value="@Filter.Search"
                          ValueChanged="@(s => OnSearch(s))"
                          Placeholder="@Localizer["stocks_grid_search_placeholder"]"
                          Adornment="@Adornment.Start"
                          AdornmentIcon="@Icons.Material.Rounded.Search"
                          IconSize="@Size.Medium"
                          Class="mt-0"/>

            @if (ShowCreateStockButton)
            {
                <MudTooltip Text="@Localizer["stocks_grid_add_tooltip"]"
                            Placement="@Placement.Bottom">
                    
                    <MudIconButton Icon="@Icons.Material.Rounded.AddCircle"
                                   Size="@Size.Small"
                                   Variant="@Variant.Outlined"
                                   Color="@Color.Secondary"
                                   OnClick="@OpenCreateStockModal"/>
                </MudTooltip>
            }
        </MudStack>
    </ToolBarContent>

    <Columns>

        <PropertyColumn Property="x => x.Title" Title="@Localizer["stocks_grid_column_title_name"]"
                        Sortable="true"/>

        <PropertyColumn Property="x => x.Symbol"
                        Title="@Localizer["stocks_grid_column_title_symbol"]"
                        Sortable="true"/>

        <PropertyColumn Property="x => x.Price"
                        Title="@Localizer["stocks_grid_column_title_price"]"
                        Sortable="true"/>

        <PropertyColumn Property="x => x.UpdatedAt" 
                        Title="@Localizer["stocks_grid_column_title_updated_at"]"
                        Sortable="true">
            
            <CellTemplate>
                @context.Item.UpdatedAt.ConvertUtcToLocal(TimeZoneHelper.UserTimeZone)
            </CellTemplate>
        </PropertyColumn>

        <PropertyColumn Property="x => x.CreatedAt" 
                        Title="@Localizer["stocks_grid_column_title_created_at"]"
                        Sortable="true">
            
            <CellTemplate>
                @context.Item.CreatedAt.ConvertUtcToLocal(TimeZoneHelper.UserTimeZone)
            </CellTemplate>
        </PropertyColumn>

        <TemplateColumn Title="@Localizer["stocks_grid_column_title_actions"]" StickyRight="true">
            
            <CellTemplate>
                
                <MudStack Row="true" Spacing="2">
                    
                    <MudTooltip Text="@Localizer["stocks_grid_action_edit"]" Placement="@Placement.Bottom">
                        <MudIconButton Icon="@Icons.Material.Rounded.Edit"
                                       Size="@Size.Small"
                                       Color="@Color.Info"
                                       Variant="@Variant.Outlined"
                                       OnClick="@(() => OnEditClick(context.Item.Id))"/>
                    </MudTooltip>
                    
                    <MudTooltip Text="@Localizer["stocks_grid_action_delete"]" Placement="@Placement.Bottom">
                        
                        <MudIconButton Icon="@Icons.Material.Rounded.Delete"
                                       Size="@Size.Small"
                                       Color="@Color.Warning"
                                       Variant="@Variant.Outlined"
                                       OnClick="@(() => OnDeleteClick(context.Item.Id))"/>
                    </MudTooltip>
                </MudStack>
            </CellTemplate>
        </TemplateColumn>
    </Columns>

    <PagerContent>
        <MudDataGridPager T="StockViewModel"/>
    </PagerContent>
</MudDataGrid>